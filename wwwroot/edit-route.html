<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, user-scalable=no, initial-scale=1, minimum-scale=1, maximum-scale=3">
        <title>AKK - Find Route</title>
        <link rel="stylesheet" type="text/css" href="css/styles.css">
        <script src="https://code.jquery.com/jquery-3.1.1.min.js" integrity="sha256-hVVnYaiADRTO2PzUGmuLJr8BLUSjGIZsDYGmIJLv2b8=" crossorigin="anonymous"></script>
        <script type="text/javascript" src="http://builds.handlebarsjs.com.s3.amazonaws.com/handlebars-latest.js"></script>
        <script type="text/javascript" src="js/config.js"></script>
        <script type="text/javascript" src="js/client.js"></script>
        <script type="text/javascript" src="js/edit-route-view-model.js"></script>
    </head>
    <body>
        <script type="text/javascript">
            var viewModel;
            $(document).ready(function () {
                Handlebars.registerHelper('if_eq', function(a, b, opts) {
    if(a == b) // Or === depending on your needs
        return opts.fn(this);
    else
        return opts.inverse(this);
});
                var template = Handlebars.compile($("#edit-route-template").html());
                var client = new Client(API_ROUTE_URL, API_SECTION_URL);
                var changed = function changed() { 
                    $('#content').html(template(viewModel)); 
                    $('#section-input-' + viewModel.selectedSection.name).prop("checked", true);
                    $('#grade-input-' + viewModel.selectedGrade.value).prop("checked", true);
                };
                viewModel = new EditRouteViewModel(client, changed);
            });
        </script>
        <script id="edit-route-template" type="text/x-handlebars-template">
            <div class="header">
                <div class="header-content">
                    <a class="header-button left" href="route-info.html?routeId={{routeId}}">
                        <svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" fill="#FFFFFF">
                            <polygon points="19.7 11 7.5 11 13.1 5.4 11.7 4 3.7 12 11.7 20 13.1 18.6 7.5 13 19.7 13"></polygon>
                        </svg>
                    </a>
                    <h1 class="page-title">Edit Route</h1>
                </div>
            </div>
            <div class="content new-route">
                <div class="content-section section-picker">
                    <h2 class="">Section</h2>
                    <div class="radio-inputs">
                        {{#each sections}}
                        <input id="section-input-{{name}}" class="section-box" onclick="viewModel.changeSection('{{sectionId}}')" name="section" type="radio">
                        <label for="section-input-{{name}}">
                            <span>{{name}}</span>
                        </label>
                        {{/each}}
                        <label class="shadow"></label>  
                        <div class="stretch"></div>
                    </div>
                </div>
                <div class="content-section grade-picker">
                    <h2>Grade</h2>
                    <div class="radio-inputs">
                        {{#each grades}}
                        <input id="grade-input-{{value}}" class="grade-box" onclick="viewModel.changeGrade({{value}})" name="grade" type="radio">
                        <label class="grade-{{value}}" for="grade-input-{{value}}">
                            <svg class="grade-checkmark" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" fill="#FFFFFF">
                                <polygon id="checkmark-shape" points="8.9999939 16.2 4.7999939 12 3.3999939 13.4 8.9999939 19 20.9999939 7 19.5999939 5.6"></polygon>
                            </svg>
                        </label>
                        {{/each}}
                        <div class="stretch"></div>
                    </div>
                </div>
                <div class="content-section number-picker">
                    <h2>Route number</h2>
                    <input id="route-number" class="number-input" type="number" onchange="viewModel.changeRouteNumber(this.value)" value="{{routeNumber}}" placeholder="Number" pattern="[0-9]*" inputmode="numeric">
                </div>
                <div class="content-section author-picker">
                    <h2>Route creator</h2>
                    <input id="author" class="author-input" type="text" onchange="viewModel.changeAuthor(this.value)" value="{{author}}" placeholder="Author">
                </div>
                                <div class="content-section color-picker">
                    <h2>Colour of holds</h2>
                    <div class="radio-inputs holdcolors">
                        {{#each holdColors}}
                        <input id="hold-input-{{value}}" onclick="viewModel.changeHoldColor({{value}})" name="hold" type="radio">
                        <label class="hold-box holdColor-{{value}}" for="hold-input-{{value}}">
                            <svg class="grade-checkmark" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" fill="#FFFFFF">
                                <polygon points="8.9999939 16.2 4.7999939 12 3.3999939 13.4 8.9999939 19 20.9999939 7 19.5999939 5.6"></polygon>  
                            </svg>
                        </label>
                        {{/each}}
                        <div class="stretch"></div>
                    </div>
                </div>
                <span id=error-message>
                    
                </span>
                <input class="submit-button create-route-button" type="button" onclick="viewModel.updateRoute()" value="Save"></input>
            </div>
        </script>
        <div id="content"></div>
    </body>
</html>